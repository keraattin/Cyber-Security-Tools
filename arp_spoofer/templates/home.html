{% extends 'layout.html' %}


{% block body %}
<div class="container">
    <table class="table table-hover" id="resultsTable">
        <thead>
          <tr>
            <th scope="col">#</th>
            <th scope="col">Target Ip Address</th>
            <th scope="col">Target MAC Address</th>
            <th scope="col">Router Ip Adress</th>
            <th scope="col">Router MAC Adress</th>
            <th scope="col">Interceptor</th>
          </tr>
        </thead>
        <tbody id="resultsTbody">
        </tbody>
    </table>
</div>
{% endblock %}


{% block scripts %}
<script type="text/javascript">
    function getSpoofedList(){
        var port = "{{ port | safe }}";
        var url = "http://localhost:"+port+"/api/arp_spoof";
        $.ajax({
            url: url,
            type: 'GET',
            dataType : 'json',
            success: function(response) {
                $("#resultsTbody").empty(); //Clear Table
                var num = 0;
                for (element in response){
                    var target_ip_addr  = response[element]["target_ip_addr"];
                    var target_mac_addr = response[element]["target_mac_addr"];
                    var router_ip_addr  = response[element]["router_ip_addr"];
                    var router_mac_addr = response[element]["router_mac_addr"];
                    var interceptor     = response[element]["interceptor"];
                    

                    $('#resultsTable tbody')
                    .append(("<tr></tr>"))
                    .append($("<td></td>").text(num))
                    .append($("<td></td>").text(target_ip_addr))
                    .append($("<td></td>").text(target_mac_addr))
                    .append($("<td></td>").text(router_ip_addr))
                    .append($("<td></td>").text(router_mac_addr))
                    .append($("<td></td>").text(interceptor))
                    num = num + 1; //Increment Index
                }
            }
        });
    } 
</script>

<script type="text/javascript">
    $(document).ready(function(){
        getSpoofedList();
    })
</script>
{% endblock %}
#!/usr/bin/env python3


# Imports
##############################################################################
from scapy.all import *
import sys
##############################################################################


# Global Values
##############################################################################
INTERFACE = "eth0"
##############################################################################



##############################################################################
def query_sniff(packet):
    if IP in packet:
        ip_src = packet[IP].src
        ip_dst = packet[IP].dst
        if packet.haslayer(DNS) and packet.getlayer(DNS).qr == 0:
            print(str(packet.getlayer(DNS).qd.qname))

##############################################################################



##############################################################################
sniff(iface = INTERFACE, filter="port 53", prn = query_sniff, store = 0)
##############################################################################